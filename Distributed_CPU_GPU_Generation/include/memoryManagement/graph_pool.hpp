#ifndef GRAPHPOOL_HPP
#define GRAPHPOOL_HPP

#include <thread>
#include <unistd.h>
#include "definition/mmpool_size.h"
#include <iostream>
#include <mutex>

template <typename T> class Graph_pool {
public:
    vector<vector<T> > graph_group;
    int next_graph = 0;
    std::mutex mtx;

    // 构造函数
    Graph_pool(int Group_Num);
    vector<T> get_next_graph();

};

// 构造函数
template <typename T> Graph_pool<T>::Graph_pool(int Group_Num) {
    graph_group.resize(Group_Num);
    next_graph = 0;
}

// 查找空块
template <typename T> vector<T> Graph_pool<T>::get_next_graph() {
    //使用锁来保护
    //获取锁
    mtx.lock(); // 获取锁
    vector<int> ret = graph_group[next_graph];
    next_graph ++;
    mtx.unlock(); // 释放锁
    return ret;
}

#endif